!function(e){void 0===e.fn.inputmask&&(e.inputmask={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},quantifiermarker:{start:"{",end:"}"},groupmarker:{start:"(",end:")"},escapeChar:"\\",mask:null,oncomplete:e.noop,onincomplete:e.noop,oncleared:e.noop,repeat:0,greedy:!0,autoUnmask:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},onKeyUp:e.noop,onKeyDown:e.noop,showMaskOnFocus:!0,showMaskOnHover:!0,onKeyValidation:e.noop,skipOptionalPartCharacter:" ",showTooltip:!1,numericInput:!1,isNumeric:!1,radixPoint:"",skipRadixDance:!1,rightAlignNumerics:!0,definitions:{9:{validator:"[0-9]",cardinality:1},a:{validator:"[A-Za-zА-яЁё]",cardinality:1},"*":{validator:"[A-Za-zА-яЁё0-9]",cardinality:1}},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},ignorables:[8,9,13,19,27,33,34,35,36,37,38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123],getMaskLength:function(e,t,i,a,n){var s=e.length;return t||("*"==i?s=a.length+1:i>1&&(s+=e.length*(i-1))),s}},escapeRegex:function(e){return e.replace(new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","gim"),"\\$1")}},e.fn.inputmask=function(t,a){var n,s=e.extend(!0,{},e.inputmask.defaults,a),r=null!==navigator.userAgent.match(new RegExp("msie 10","i")),o=null!==navigator.userAgent.match(new RegExp("iphone","i")),u=null!==navigator.userAgent.match(new RegExp("android.*safari.*","i")),l=null!==navigator.userAgent.match(new RegExp("android.*chrome.*","i")),c=p("paste")&&!r?"paste":p("input")?"input":"propertychange",f=0;if("string"==typeof t)switch(t){case"mask":return h(s.alias,a),0==(n=m()).length?this:this.each(function(){_(e.extend(!0,{},n),0).mask(this)});case"unmaskedvalue":var d=e(this);return d.data("_inputmask")?(n=d.data("_inputmask").masksets,f=d.data("_inputmask").activeMasksetIndex,s=d.data("_inputmask").opts,_(n,f).unmaskedvalue(d)):d.val();case"remove":return this.each(function(){var t=e(this);if(t.data("_inputmask")){var i;n=t.data("_inputmask").masksets,f=t.data("_inputmask").activeMasksetIndex,s=t.data("_inputmask").opts,this._valueSet(_(n,f).unmaskedvalue(t,!0)),t.removeData("_inputmask"),t.unbind(".inputmask"),t.removeClass("focus.inputmask"),Object.getOwnPropertyDescriptor&&(i=Object.getOwnPropertyDescriptor(this,"value")),i&&i.get?this._valueGet&&Object.defineProperty(this,"value",{get:this._valueGet,set:this._valueSet}):document.__lookupGetter__&&this.__lookupGetter__("value")&&this._valueGet&&(this.__defineGetter__("value",this._valueGet),this.__defineSetter__("value",this._valueSet));try{delete this._valueGet,delete this._valueSet}catch(e){this._valueGet=void 0,this._valueSet=void 0}}});case"getemptymask":return this.data("_inputmask")?(n=this.data("_inputmask").masksets,f=this.data("_inputmask").activeMasksetIndex,n[f]._buffer.join("")):"";case"hasMaskedValue":return!!this.data("_inputmask")&&!this.data("_inputmask").opts.autoUnmask;case"isComplete":return n=this.data("_inputmask").masksets,f=this.data("_inputmask").activeMasksetIndex,s=this.data("_inputmask").opts,_(n,f).isComplete(this[0]._valueGet().split(""));case"getmetadata":return this.data("_inputmask")?(n=this.data("_inputmask").masksets,f=this.data("_inputmask").activeMasksetIndex,n[f].metadata):void 0;default:return h(t,a)||(s.mask=t),0==(n=m()).length?this:this.each(function(){_(e.extend(!0,{},n),f).mask(this)})}else{if("object"==typeof t)return h((s=e.extend(!0,{},e.inputmask.defaults,t)).alias,t),0==(n=m()).length?this:this.each(function(){_(e.extend(!0,{},n),f).mask(this)});if(null==t)return this.each(function(){var t=e(this).attr("data-inputmask");if(t&&""!=t)try{t=t.replace(new RegExp("'","g"),'"');var i=e.parseJSON("{"+t+"}");e.extend(!0,i,a),h((s=e.extend(!0,{},e.inputmask.defaults,i)).alias,i),s.alias=void 0,e(this).inputmask(s)}catch(e){}})}function p(e){var t=document.createElement("input"),i=(e="on"+e)in t;return i||(t.setAttribute(e,"return;"),i="function"==typeof t[e]),t=null,i}function h(t,i){var a=s.aliases[t];return!!a&&(a.alias&&h(a.alias),e.extend(!0,s,a),e.extend(!0,s,i),!0)}function v(t){s.numericInput&&(t=t.split("").reverse().join(""));var i=!1,a=0,n=s.greedy,r=s.repeat;"*"==r&&(n=!1),1==t.length&&0==n&&0!=r&&(s.placeholder="");for(var o=e.map(t.split(""),function(e,t){var n=[];if(e==s.escapeChar)i=!0;else if(e!=s.optionalmarker.start&&e!=s.optionalmarker.end||i){var r=s.definitions[e];if(r&&!i)for(var o=0;o<r.cardinality;o++)n.push(g(a+o));else n.push(e),i=!1;return a+=n.length,n}}),u=o.slice(),l=1;l<r&&n;l++)u=u.concat(o.slice());return{mask:u,repeat:r,greedy:n}}function k(t){s.numericInput&&(t=t.split("").reverse().join(""));var i=!1,a=!1,n=!1;return e.map(t.split(""),function(e,t){var r=[];if(e==s.escapeChar)a=!0;else if(e!=s.optionalmarker.start||a){if(e!=s.optionalmarker.end||a){var o=s.definitions[e];if(o&&!a){for(var u=o.prevalidator,l=u?u.length:0,c=1;c<o.cardinality;c++){var f=l>=c?u[c-1]:[],d=f.validator,p=f.cardinality;r.push({fn:d?"string"==typeof d?new RegExp(d):new function(){this.test=d}:new RegExp("."),cardinality:p||1,optionality:i,newBlockMarker:1==i&&n,offset:0,casing:o.casing,def:o.definitionSymbol||e}),1==i&&(n=!1)}r.push({fn:o.validator?"string"==typeof o.validator?new RegExp(o.validator):new function(){this.test=o.validator}:new RegExp("."),cardinality:o.cardinality,optionality:i,newBlockMarker:n,offset:0,casing:o.casing,def:o.definitionSymbol||e})}else r.push({fn:null,cardinality:0,optionality:i,newBlockMarker:n,offset:0,casing:null,def:e}),a=!1;return n=!1,r}i=!1,n=!0}else i=!0,n=!0})}function m(){var t=[],a=[],n=[];function r(e){return s.optionalmarker.start+e+s.optionalmarker.end}function o(e){var t=e.length;for(i=0;i<t&&e.charAt(i)!=s.optionalmarker.start;i++);var a=[e.substring(0,i)];return i<t&&a.push(e.substring(i+1,t)),a}function u(n,l,c){var f,d,p=function(e){var t=0,a=0,n=e.length;for(i=0;i<n&&(e.charAt(i)==s.optionalmarker.start&&t++,e.charAt(i)==s.optionalmarker.end&&a++,!(t>0&&t==a));i++);var r=[e.substring(0,i)];return i<n&&r.push(e.substring(i+1,n)),r}(l),h=o(p[0]);h.length>1?(f=n+h[0]+r(h[1])+(p.length>1?p[1]:""),-1==e.inArray(f,a)&&""!=f&&(a.push(f),d=v(f),t.push({mask:f,_buffer:d.mask,buffer:d.mask.slice(),tests:k(f),lastValidPosition:-1,greedy:d.greedy,repeat:d.repeat,metadata:c})),f=n+h[0]+(p.length>1?p[1]:""),-1==e.inArray(f,a)&&""!=f&&(a.push(f),d=v(f),t.push({mask:f,_buffer:d.mask,buffer:d.mask.slice(),tests:k(f),lastValidPosition:-1,greedy:d.greedy,repeat:d.repeat,metadata:c})),o(h[1]).length>1&&u(n+h[0],h[1]+p[1],c),p.length>1&&o(p[1]).length>1&&(u(n+h[0]+r(h[1]),p[1],c),u(n+h[0],p[1],c))):(f=n+p,-1==e.inArray(f,a)&&""!=f&&(a.push(f),d=v(f),t.push({mask:f,_buffer:d.mask,buffer:d.mask.slice(),tests:k(f),lastValidPosition:-1,greedy:d.greedy,repeat:d.repeat,metadata:c})))}return e.isFunction(s.mask)&&(s.mask=s.mask.call(this,s)),e.isArray(s.mask)?e.each(s.mask,function(e,t){null!=t.mask?u("",t.mask.toString(),t):u("",t.toString())}):u("",s.mask.toString()),function(e){var t=/(?:[?*+]|\{[0-9]+(?:,[0-9]*)?\})\??|[^.?*+^${[]()|\\]+|./g;function i(){this.matches=[],this.isGroup=!1,this.isOptional=!1,this.isQuantifier=!1}var a,r,o=new i,u=[];for(n=[];a=t.exec(e);)switch((r=a[0]).charAt(0)){case s.optionalmarker.end:case s.groupmarker.end:var l=u.pop();u.length>0?u[u.length-1].matches.push(l):(n.push(l),o=l);break;case s.optionalmarker.start:!o.isGroup&&o.matches.length>0&&n.push(o),(o=new i).isOptional=!0,u.push(o);break;case s.groupmarker.start:!o.isGroup&&o.matches.length>0&&n.push(o),(o=new i).isGroup=!0,u.push(o);break;case s.quantifiermarker.start:var c=new i;c.isQuantifier=!0,c.matches.push(r),u.length>0?u[u.length-1].matches.push(c):o.matches.push(c);break;default:u.length>0?u[u.length-1].matches.push(r):((o.isGroup||o.isOptional)&&(o=new i),o.matches.push(r))}o.matches.length>0&&n.push(o)}(s.mask),s.greedy?t:t.sort(function(e,t){return e.mask.length-t.mask.length})}function g(e){return s.placeholder.charAt(e%s.placeholder.length)}function _(t,i){var a,n,r=!1,f=v().join("");function d(){return t[i]}function p(){return d().tests}function h(){return d()._buffer}function v(){return d().buffer}function k(a,n,r){function o(e,t,i,a){for(var n=y(e),r=i?1:0,o="",u=t.buffer,l=t.tests[n].cardinality;l>r;l--)o+=M(u,n-(l-1));return i&&(o+=i),null!=t.tests[n].fn?t.tests[n].fn.test(o,u,e,a,s):(i==M(t._buffer,e,!0)||i==s.skipOptionalPartCharacter)&&{refresh:!0,c:M(t._buffer,e,!0),pos:e}}if(r=!0===r)return!0===(l=o(a,d(),n,r))&&(l={pos:a}),l;var u=[],l=!1,c=i,f=v().slice(),p=d().lastValidPosition,h=(x(a),[]);return e.each(t,function(e,t){if("object"==typeof t){i=e;var s,k=a,m=d().lastValidPosition;if(m==p){if(k-p>1)for(var g=-1==m?0:m;g<k&&!1!==(s=o(g,d(),f[g],!0));g++){C(v(),g,f[g],!0),!0===s&&(s={pos:g});var y=s.pos||g;d().lastValidPosition<y&&(d().lastValidPosition=y)}if(!_(k)&&!o(k,d(),n,r)){for(var x=P(k)-k,M=0;M<x&&!1===o(++k,d(),n,r);M++);h.push(i)}}if((d().lastValidPosition>=p||i==c)&&k>=0&&k<b()){if(!1!==(l=o(k,d(),n,r))){!0===l&&(l={pos:k});y=l.pos||k;d().lastValidPosition<y&&(d().lastValidPosition=y)}u.push({activeMasksetIndex:e,result:l})}}}),i=c,function(i,s){var r=!1;if(e.each(s,function(t,a){if(r=-1==e.inArray(a.activeMasksetIndex,i)&&!1!==a.result)return!1}),r)s=e.map(s,function(a,n){if(-1==e.inArray(a.activeMasksetIndex,i))return a;t[a.activeMasksetIndex].lastValidPosition=p});else{var u=-1,l=-1;e.each(s,function(t,a){-1!=e.inArray(a.activeMasksetIndex,i)&&!1!==a.result&(-1==u||u>a.result.pos)&&(u=a.result.pos,l=a.activeMasksetIndex)}),s=e.map(s,function(s,r){if(-1!=e.inArray(s.activeMasksetIndex,i)){if(s.result.pos==u)return s;if(!1!==s.result){for(var c=a;c<u;c++){if(rsltValid=o(c,t[s.activeMasksetIndex],t[l].buffer[c],!0),!1===rsltValid){t[s.activeMasksetIndex].lastValidPosition=u-1;break}C(t[s.activeMasksetIndex].buffer,c,t[l].buffer[c],!0),t[s.activeMasksetIndex].lastValidPosition=c}return rsltValid=o(u,t[s.activeMasksetIndex],n,!0),!1!==rsltValid&&(C(t[s.activeMasksetIndex].buffer,u,n,!0),t[s.activeMasksetIndex].lastValidPosition=u),s}}})}return s}(h,u)}function m(){var n=i,s={activeMasksetIndex:0,lastValidPosition:-1,next:-1};e.each(t,function(e,t){"object"==typeof t&&(i=e,d().lastValidPosition>s.lastValidPosition?(s.activeMasksetIndex=e,s.lastValidPosition=d().lastValidPosition,s.next=P(d().lastValidPosition)):d().lastValidPosition==s.lastValidPosition&&(-1==s.next||s.next>P(d().lastValidPosition))&&(s.activeMasksetIndex=e,s.lastValidPosition=d().lastValidPosition,s.next=P(d().lastValidPosition)))}),n!=(i=-1!=s.lastValidPosition&&t[n].lastValidPosition==s.lastValidPosition?n:s.activeMasksetIndex)&&(V(v(),P(s.lastValidPosition),b()),d().writeOutBuffer=!0),a.data("_inputmask").activeMasksetIndex=i}function _(e){var t=y(e),i=p()[t];return null!=i&&i.fn}function y(e){return e%p().length}function b(){return s.getMaskLength(h(),d().greedy,d().repeat,v(),s)}function P(e){var t=b();if(e>=t)return t;for(var i=e;++i<t&&!_(i););return i}function x(e){var t=e;if(t<=0)return 0;for(;--t>0&&!_(t););return t}function C(e,t,i,a){a&&(t=A(e,t));var n=p()[y(t)],s=i;if(null!=s&&null!=n)switch(n.casing){case"upper":s=i.toUpperCase();break;case"lower":s=i.toLowerCase()}e[t]=s}function M(e,t,i){return i&&(t=A(e,t)),e[t]}function A(e,t){for(var i;null==e[t]&&e.length<b();)for(i=0;void 0!==h()[i];)e.push(h()[i++]);return t}function E(e,t,i){e._valueSet(t.join("")),null!=i&&G(e,i)}function V(e,t,i,a){for(var n=t,s=b();n<i&&n<s;n++)!0===a?_(n)||C(e,n,""):C(e,n,M(h().slice(),n,!0))}function j(e,t){var i=y(t);C(e,t,M(h(),i))}function I(a,n,s,r,o){var u=null!=r?r.slice():w(a._valueGet()).split("");e.each(t,function(e,t){"object"==typeof t&&(t.buffer=t._buffer.slice(),t.lastValidPosition=-1,t.p=-1)}),!0!==s&&(i=0),n&&a._valueSet("");b();e.each(u,function(t,i){if(!0===o){var r=d().p,u=-1==r?r:x(r),l=-1==u?t:P(u);-1==e.inArray(i,h().slice(u+1,l))&&e(a).trigger("_keypress",[!0,i.charCodeAt(0),n,s,t])}else e(a).trigger("_keypress",[!0,i.charCodeAt(0),n,s,t])}),!0===s&&-1!=d().p&&(d().lastValidPosition=x(d().p))}function w(t){return t.replace(new RegExp("("+function(t){return e.inputmask.escapeRegex.call(this,t)}(h().join(""))+")*$"),"")}function S(e){for(var t=v(),i=t.slice(),a=i.length-1;a>=0;a--){var n=y(a);if(!p()[n].optionality)break;if(_(a)&&k(a,t[a],!0))break;i.pop()}E(e,i)}function O(e){!r||"number"!=typeof e||s.greedy&&""==s.placeholder||(e=v().length-e);return e}function G(t,i,a){var n,r=t.jquery&&t.length>0?t[0]:t;if("number"!=typeof i)return e(t).is(":visible")?(r.setSelectionRange?(i=r.selectionStart,a=r.selectionEnd):document.selection&&document.selection.createRange&&(a=(i=0-(n=document.selection.createRange()).duplicate().moveStart("character",-1e5))+n.text.length),{begin:i=O(i),end:a=O(a)}):{begin:0,end:0};i=O(i),a=O(a),e(t).is(":visible")&&(a="number"==typeof a?a:i,r.scrollLeft=r.scrollWidth,0==s.insertMode&&i==a&&a++,r.setSelectionRange?(r.selectionStart=i,r.selectionEnd=u?i:a):r.createTextRange&&((n=r.createTextRange()).collapse(!0),n.moveEnd("character",a),n.moveStart("character",i),n.select()))}function T(a){if("*"!=s.repeat){var n=!1,r=0,o=i;return e.each(t,function(e,t){if("object"==typeof t){i=e;var s=x(b());if(t.lastValidPosition>=r&&t.lastValidPosition==s){for(var o=!0,u=0;u<=s;u++){var l=_(u),c=y(u);if(l&&(null==a[u]||a[u]==g(u))||!l&&a[u]!=h()[c]){o=!1;break}}if(n=n||o)return!1}r=t.lastValidPosition}}),i=o,n}}return this.unmaskedvalue=function(t,i){return r=t.data("_inputmask").isRTL,function(t,i){if(!p()||!0!==i&&t.hasClass("hasDatepicker"))return t[0]._valueGet();var a=e.map(v(),function(e,t){return _(t)&&k(t,e,!0)?e:null});return(r?a.reverse():a).join("")}(t,i)},this.isComplete=function(e){return T(e)},this.mask=function(u){if((a=e(u)).is(":input")){if(a.data("_inputmask",{masksets:t,activeMasksetIndex:i,opts:s,isRTL:!1}),s.showTooltip&&a.prop("title",d().mask),d().greedy=d().greedy?d().greedy:0==d().repeat,null!=a.attr("maxLength")){var A=a.prop("maxLength");A>-1&&e.each(t,function(e,t){"object"==typeof t&&"*"==t.repeat&&(t.repeat=A)}),b()>=A&&A>-1&&(A<h().length&&(h().length=A),0==d().greedy&&(d().repeat=Math.round(A/h().length)),a.prop("maxLength",2*b()))}!function(t){var i;Object.getOwnPropertyDescriptor&&(i=Object.getOwnPropertyDescriptor(t,"value"));if(i&&i.get){if(!t._valueGet){var a=i.get,n=i.set;t._valueGet=function(){return r?a.call(this).split("").reverse().join(""):a.call(this)},t._valueSet=function(e){n.call(this,r?e.split("").reverse().join(""):e)},Object.defineProperty(t,"value",{get:function(){var t=e(this),i=e(this).data("_inputmask"),n=i.masksets,s=i.activeMasksetIndex;return i&&i.opts.autoUnmask?t.inputmask("unmaskedvalue"):a.call(this)!=n[s]._buffer.join("")?a.call(this):""},set:function(t){n.call(this,t),e(this).triggerHandler("setvalue.inputmask")}})}}else if(document.__lookupGetter__&&t.__lookupGetter__("value")){if(!t._valueGet){var a=t.__lookupGetter__("value"),n=t.__lookupSetter__("value");t._valueGet=function(){return r?a.call(this).split("").reverse().join(""):a.call(this)},t._valueSet=function(e){n.call(this,r?e.split("").reverse().join(""):e)},t.__defineGetter__("value",function(){var t=e(this),i=e(this).data("_inputmask"),n=i.masksets,s=i.activeMasksetIndex;return i&&i.opts.autoUnmask?t.inputmask("unmaskedvalue"):a.call(this)!=n[s]._buffer.join("")?a.call(this):""}),t.__defineSetter__("value",function(t){n.call(this,t),e(this).triggerHandler("setvalue.inputmask")})}}else if(t._valueGet||(t._valueGet=function(){return r?this.value.split("").reverse().join(""):this.value},t._valueSet=function(e){this.value=r?e.split("").reverse().join(""):e}),null==e.valHooks.text||1!=e.valHooks.text.inputmaskpatch){var a=e.valHooks.text&&e.valHooks.text.get?e.valHooks.text.get:function(e){return e.value},n=e.valHooks.text&&e.valHooks.text.set?e.valHooks.text.set:function(e,t){return e.value=t,e};jQuery.extend(e.valHooks,{text:{get:function(t){var i=e(t);if(i.data("_inputmask")){if(i.data("_inputmask").opts.autoUnmask)return i.inputmask("unmaskedvalue");var n=a(t),s=i.data("_inputmask"),r=s.masksets,o=s.activeMasksetIndex;return n!=r[o]._buffer.join("")?n:""}return a(t)},set:function(t,i){var a=e(t),s=n(t,i);return a.data("_inputmask")&&a.triggerHandler("setvalue.inputmask"),s},inputmaskpatch:!0}})}}(u);var D,R,K,L=!1,N=!1;if(s.numericInput&&(s.isNumeric=s.numericInput),("rtl"==u.dir||s.numericInput&&s.rightAlignNumerics||s.isNumeric&&s.rightAlignNumerics)&&a.css("text-align","right"),"rtl"==u.dir||s.numericInput){u.dir="ltr",a.removeAttr("dir");var B=a.data("_inputmask");B.isRTL=!0,a.data("_inputmask",B),r=!0}a.unbind(".inputmask"),a.removeClass("focus.inputmask"),a.closest("form").bind("submit",function(){f!=v().join("")&&a.change()}).bind("reset",function(){setTimeout(function(){a.trigger("setvalue")},0)}),a.bind("mouseenter.inputmask",function(){!e(this).hasClass("focus.inputmask")&&s.showMaskOnHover&&this._valueGet()!=v().join("")&&E(this,v())}).bind("blur.inputmask",function(){var a=e(this),n=this._valueGet(),r=v();a.removeClass("focus.inputmask"),f!=v().join("")&&a.change(),s.clearMaskOnLostFocus&&""!=n&&(n==h().join("")?this._valueSet(""):S(this)),!1===T(r)&&(a.trigger("incomplete"),s.clearIncomplete&&(e.each(t,function(e,t){"object"==typeof t&&(t.buffer=t._buffer.slice(),t.lastValidPosition=-1)}),i=0,s.clearMaskOnLostFocus?this._valueSet(""):E(this,r=h().slice())))}).bind("focus.inputmask",function(){var t=e(this),i=this._valueGet();s.showMaskOnFocus&&!t.hasClass("focus.inputmask")&&(!s.showMaskOnHover||s.showMaskOnHover&&""==i)&&this._valueGet()!=v().join("")&&E(this,v(),P(d().lastValidPosition)),t.addClass("focus.inputmask"),f=v().join("")}).bind("mouseleave.inputmask",function(){var t=e(this);s.clearMaskOnLostFocus&&(t.hasClass("focus.inputmask")||this._valueGet()==t.attr("placeholder")||(this._valueGet()==h().join("")||""==this._valueGet()?this._valueSet(""):S(this)))}).bind("click.inputmask",function(){var t=this;setTimeout(function(){var i=G(t),a=v();if(i.begin==i.end){var n,r=s.isRTL?O(i.begin):i.begin,o=d().lastValidPosition;r<(n=s.isNumeric&&!1===s.skipRadixDance&&""!=s.radixPoint&&-1!=e.inArray(s.radixPoint,a)?s.numericInput?P(e.inArray(s.radixPoint,a)):e.inArray(s.radixPoint,a):P(o))?_(r)?G(t,r):G(t,P(r)):G(t,n)}},0)}).bind("dblclick.inputmask",function(){var e=this;setTimeout(function(){G(e,0,P(d().lastValidPosition))},0)}).bind(c+".inputmask dragdrop.inputmask drop.inputmask",function(t){var i=this,a=e(i);if("propertychange"==t.type&&i._valueGet().length<=b())return!0;setTimeout(function(){I(i,!0,!1,void 0,!0),!0===T(v())&&a.trigger("complete"),a.click()},0)}).bind("setvalue.inputmask",function(){I(this,!0),f=v().join(""),this._valueGet()==h().join("")&&this._valueSet("")}).bind("_keypress.inputmask",Q).bind("complete.inputmask",s.oncomplete).bind("incomplete.inputmask",s.onincomplete).bind("cleared.inputmask",s.oncleared).bind("keyup.inputmask",function(t){var i=e(this),a=t.keyCode,r=v();l&&a==s.keyCode.BACKSPACE&&n==this._valueGet()&&W.call(this,t);s.onKeyUp.call(this,t,r,s),a==s.keyCode.TAB&&s.showMaskOnFocus&&(i.hasClass("focus.inputmask")&&0==this._valueGet().length?(E(this,r=h().slice()),G(this,0),f=v().join("")):(E(this,r),G(this,0,b())))}),l?a.bind("input.inputmask",function(t){var i=e(this);n=v().join(""),I(this,!1,!1),E(this,v()),!0===T(v())&&i.trigger("complete"),i.click()}):a.bind("keydown.inputmask",W).bind("keypress.inputmask",Q),I(u,!0,!1),f=v().join("");try{D=document.activeElement}catch(e){}D===u?(a.addClass("focus.inputmask"),G(u,P(d().lastValidPosition))):s.clearMaskOnLostFocus?v().join("")==h().join("")?u._valueSet(""):S(u):E(u,v()),R=u,K=e._data(R).events,e.each(K,function(t,i){e.each(i,function(e,t){if("inputmask"==t.namespace&&"setvalue"!=t.type&&"_keypress"!=t.type){var i=t.handler;t.handler=function(e){if(!this.readOnly&&!this.disabled)return i.apply(this,arguments);e.preventDefault}}})})}function H(e,t,i,a){var n=v();if(!1!==a)for(;!_(e)&&e-1>=0;)e--;for(var s=e;s<t&&s<b();s++)if(_(s)){j(n,s);var r=P(s),o=M(n,r);if(o!=g(r))if(r<b()&&!1!==k(s,o,!0)&&p()[y(s)].def==p()[y(r)].def)C(n,s,M(n,r),!0),r<t&&j(n,r);else if(_(s))break}else j(n,s);if(null!=i&&C(n,x(t),i),0==d().greedy){var u=w(n.join("")).split("");n.length=u.length;s=0;for(var l=n.length;s<l;s++)n[s]=u[s];0==n.length&&(d().buffer=h().slice())}return e}function U(e,t,i,a){for(var n=v(),s=e;s<=t&&s<b();s++)if(_(s)){var r=M(n,s,!0);if(C(n,s,i,!0),r!=g(s)){var o=P(s);if(!(o<b()))break;if(!1!==k(o,r,!0)&&p()[y(s)].def==p()[y(o)].def)i=r;else{if(_(o))break;i=r}}else if(i=r,!0!==a)break}else j(n,s);var u=n.length;if(0==d().greedy){var l=w(n.join("")).split("");n.length=l.length;s=0;for(var c=n.length;s<c;s++)n[s]=l[s];0==n.length&&(d().buffer=h().slice())}return t-(u-n.length)}function F(e,i,a){if(s.numericInput||r){switch(i){case s.keyCode.BACKSPACE:i=s.keyCode.DELETE;break;case s.keyCode.DELETE:i=s.keyCode.BACKSPACE}if(r){var n=a.end;a.end=a.begin,a.begin=n}}var o=!0;if(a.begin==a.end){var u=i==s.keyCode.BACKSPACE?a.begin-1:a.begin;s.isNumeric&&""!=s.radixPoint&&v()[u]==s.radixPoint&&(a.begin=v().length-1==u?a.begin:i==s.keyCode.BACKSPACE?u:P(u),a.end=a.begin),o=!1,i==s.keyCode.BACKSPACE?a.begin--:i==s.keyCode.DELETE&&a.end++}else a.end-a.begin!=1||s.insertMode||(o=!1,i==s.keyCode.BACKSPACE&&a.begin--);V(v(),a.begin,a.end);var l=b();if(0==s.greedy)H(a.begin,l,void 0,!r&&i==s.keyCode.BACKSPACE&&!o);else{for(var c=a.begin,f=a.begin;f<a.end;f++)!_(f)&&o||(c=H(a.begin,l,void 0,!r&&i==s.keyCode.BACKSPACE&&!o));o||(a.begin=c)}var p=P(-1);V(v(),a.begin,a.end,!0),I(e,!1,null==t[1]||p>=a.end,v()),d().lastValidPosition<p?(d().lastValidPosition=-1,d().p=p):d().p=a.begin}function W(t){L=!1;var i=this,a=e(i),n=t.keyCode,r=G(i);n==s.keyCode.BACKSPACE||n==s.keyCode.DELETE||o&&127==n||t.ctrlKey&&88==n?(t.preventDefault(),88==n&&(f=v().join("")),F(i,n,r),m(),E(i,v(),d().p),i._valueGet()==h().join("")&&a.trigger("cleared"),s.showTooltip&&a.prop("title",d().mask)):n==s.keyCode.END||n==s.keyCode.PAGE_DOWN?setTimeout(function(){var e=P(d().lastValidPosition);s.insertMode||e!=b()||t.shiftKey||e--,G(i,t.shiftKey?r.begin:e,e)},0):n==s.keyCode.HOME&&!t.shiftKey||n==s.keyCode.PAGE_UP?G(i,0,t.shiftKey?r.begin:0):n==s.keyCode.ESCAPE||90==n&&t.ctrlKey?(I(i,!0,!1,f.split("")),a.click()):n!=s.keyCode.INSERT||t.shiftKey||t.ctrlKey?0!=s.insertMode||t.shiftKey||(n==s.keyCode.RIGHT?setTimeout(function(){var e=G(i);G(i,e.begin)},0):n==s.keyCode.LEFT&&setTimeout(function(){var e=G(i);G(i,e.begin-1)},0)):(s.insertMode=!s.insertMode,G(i,s.insertMode||r.begin!=b()?r.begin:r.begin-1));var u=G(i);!0===s.onKeyDown.call(this,t,v(),s)&&G(i,u.begin,u.end),N=-1!=e.inArray(n,s.ignorables)}function Q(a,n,o,u,l,c){if(null==o&&L)return!1;L=!0;var f=e(this);a=a||window.event;var p,h;o=o||a.which||a.charCode||a.keyCode;if(!(a.ctrlKey&&a.altKey||!(a.ctrlKey||a.metaKey||N)||!0===n))return!0;if(o){!0!==n&&46==o&&0==a.shiftKey&&","==s.radixPoint&&(o=44);var _,y,A,V=String.fromCharCode(o);if(n){var j=l?c:d().lastValidPosition+1;_={begin:j,end:j}}else _=G(this);var I=(p=_.begin,h=_.end,r?p-h>1||p-h==1&&s.insertMode:h-p>1||h-p==1&&s.insertMode),w=i;I&&(i=w,e.each(t,function(e,t){"object"==typeof t&&(i=e,d().undoBuffer=v().join(""))}),F(this,s.keyCode.DELETE,_),s.insertMode||e.each(t,function(e,t){"object"==typeof t&&(i=e,U(_.begin,b(),g(_.begin),!0),d().lastValidPosition=P(d().lastValidPosition))}),i=w);var S=v().join("").indexOf(s.radixPoint);s.isNumeric&&!0!==n&&-1!=S&&(s.greedy&&_.begin<=S?(_.begin=x(_.begin),_.end=_.begin):V==s.radixPoint&&(_.begin=S,_.end=_.begin));var O=_.begin;y=k(O,V,l),!0===l&&(y=[{activeMasksetIndex:i,result:y}]);var D=-1;if(e.each(y,function(e,t){i=t.activeMasksetIndex,d().writeOutBuffer=!0;var a=t.result;if(!1!==a){var n=!1,r=v();if(!0!==a&&(n=a.refresh,O=null!=a.pos?a.pos:O,V=null!=a.c?a.c:V),!0!==n){if(1==s.insertMode){for(var o=b(),u=r.slice();M(u,o,!0)!=g(o)&&o>=O;)o=0==o?-1:x(o);if(o>=O){U(O,r.length,V);var c=d().lastValidPosition,f=P(c);f!=b()&&c>=O&&M(v(),f,!0)!=g(f)&&(d().lastValidPosition=f)}else d().writeOutBuffer=!1}else C(r,O,V,!0);(-1==D||D>P(O))&&(D=P(O))}else if(!l){var p=O<b()?O+1:O;(-1==D||D>p)&&(D=p)}D>d().p&&(d().p=D)}}),!0!==l&&(i=w,m()),!1!==u&&(e.each(y,function(e,t){if(t.activeMasksetIndex==i)return A=t,!1}),null!=A)){var R=this;if(setTimeout(function(){s.onKeyValidation.call(R,A.result,s)},0),d().writeOutBuffer&&!1!==A.result){var K,B=v();K=n?void 0:s.numericInput?O>S?x(D):V==s.radixPoint?D-1:x(D-1):D,E(this,B,K),!0!==n&&setTimeout(function(){!0===T(B)&&f.trigger("complete")},0)}else I&&(d().buffer=d().undoBuffer.split(""))}s.showTooltip&&f.prop("title",d().mask),a.preventDefault()}}},this}return this})}(jQuery);